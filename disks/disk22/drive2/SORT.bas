
   10 I=0
   20 DIM A$(90),SL(12),SR(12)
   30 X=OPENUP"CL"
   40 Y=OPENOUT"C"
   50 REPEAT
   60 REPEAT
   70 I=I+1
   80 INPUT#X,A$(I)
   90 UNTIL A$(I)="*"
  100 PROCSORT(I-1)
  110 FOR J=1 TO I
  120 PRINT#Y,A$(J)
  130 NEXT J
  140 I=0
  150 UNTIL EOF#X
  160 CLOSE#0
  170 *RENAME C CLASS
  180 END
  190 DEF PROCSORT(N)
  195 LOCAL I,J
  200 FOR J=1 TO N:PRINT A$(J):A=GET:NEXT J
  210 S=1:SL(1)=1:SR(1)=N
  220 L=SL(S):R=SR(S):S=S-1
  230 I=L:J=R:X$=A$(INT((L+R)/2))
  240 IF A$(I)<X$ THEN I=I+1:GOTO 240
  250 IF X$<A$(J) THEN J=J-1:GOTO 250
  260 IF I>J THEN 290
  270 W$=A$(I):A$(I)=A$(J):A$(J)=W$
  280 I=I+1:J=J-1
  290 IF I<=J THEN 240
  300 IF I>=R THEN 320
  310 S=S+1:SL(S)=I:SR(S)=R
  320 R=J
  330 IF L<R THEN 230
  340 IF S<>0 THEN 220
  345 FOR J=1 TO N:PRINT A$(J):A=GET:NEXT J
  350 ENDPROC

