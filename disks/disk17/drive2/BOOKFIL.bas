
    1MODE 1
    5 REM *** MAIN PROGRAM 12/3/85 ***
   10 DIM C$(10),P(10)
   20 CLS
   25 ON ERROR GOTO 680
   30 PRINTTAB(10,5);"MAIN MENU";TAB(10,6);"---------"
   40 PRINTTAB(5,10);"Store            (1)"
   50 PRINTTAB(5,12);"Retrieve         (2)"
   60 PRINTTAB(5,14);"Check Entries    (3)"
   65 PRINTTAB(5,16);"Print catalogue  (4)"
   67 PRINTTAB(5,18);"Increase Prices  (5)"
   70 PRINTTAB(5,20);"Exit Program     (6)"
   80 PRINTTAB(10,22);"Please give your choice :";
   85 N=VAL(GET$)
   90 IF N<1 OR N>5 THEN 20
  100 ON N GOTO 115,113,740,111,112,680
  110 
  111CHAIN":2.PRINT"
  112CHAIN":2.MULTPRC"
  113CHAIN":2.PTEMP"
  115 ON ERROR GOTO ***
  120 PROCCOPY
  130 CLS:Z$=STRING$(40,"     ")
  140 PRINTTAB(10,5);"FILE INPUT";TAB(10,6);"----------"
  150 PROCCLR
  160 INPUTLINE"Author :"A$
  170 IF A$="STOP" THEN 440
  180 PROCCLR
  190 INPUTLINE"Title  :"T$
  200 PROCCLR
  210 INPUTLINE"Publisher,Place & Date :"P$
  220 PROCCLR 
  230 INPUTLINE"Pages & Plates :"I$
  240 PROCCLR
  250 INPUTLINE"Binding & Size(mm) :"B$
  260 PROCCLR
  270 INPUT"Box Number :"N%
  280 PROCCLR
  290 INPUT"Number of Copies :"M%
  300 PRINT#X,A$,T$,P$,I$,B$,N%,M%
  310 FOR I=1 TO M%
  320 PROCCLR
  330 PRINTTAB(5,9);"Book ";I;TAB(5,10);
  340 INPUTLINE"Condition :"C$(I)
  350 PROCCLR
  360 INPUT"Price :"P(I)
  370 PRINT#X,C$(I),P(I)
  380 NEXT I
  390 PROCCLR
  400 INPUTLINE"NOTES :"N$
  410 INPUTLINE N1$
  420 PRINT#X,N$,N1$
  430 GOTO 130
  440 CLOSE# X
  460 *REN. BK BOOKS
  470 GOTO 20
  480 
  680 MODE 7:PRINT'':CLOSE#0
  700 END
  710 DEF PROCCLR
  720 PRINTTAB(5,10);Z$;TAB(5,10);
  730 ENDPROC
  750 CLS:PRINT:PRINT
  760 Y=OPENUP "BOOKS"
  770 X=OPENOUT ":2.BOOKS"
  780 REPEAT
  790 PRINT:PRINT:PRINT
  800 INPUT#Y,A$,T$,P$,I$,B$,N%,M%
  810 PRINTA$,T$,P$,I$,B$,N%,M%
  820 FOR I=1 TO M%
  830 INPUT#Y,C$(I),P(I)
  840 PRINTC$(I),P(I)
  850 NEXT I
  860 INPUT#Y,N$,N1$
  870 PRINT N$,N1$
  880 INPUT"THROW OUT ",Q$:IF Q$="Y" THEN 1190
  890 INPUT"FILE O.K. ",Q$:IF Q$="Y" OR Q$="y" THEN 1140
  900 PRINTA$
  910 INPUTLINE"AUTHOR :"Q$:IF Q$<>"" THEN A$=Q$
  920 PRINT T$
  930 INPUTLINE"TITLE :"Q$:IF Q$<>"" THEN T$=Q$
  940 PRINT P$
  950 INPUTLINE"PUBLISHING :"Q$:IF Q$<>"" THEN P$=Q$
  960 PRINT I$
  970 INPUTLINE"PGS & PLTS :"Q$:IF Q$<>"" THEN I$=Q$
  980 PRINT B$
  990 INPUTLINE"BINDING & SIZE :"Q$:IF Q$<>"" THEN B$=Q$
 1000 PRINT N%
 1010 INPUT"BOX NUMBER :"Q%:IF Q%<>0 THEN N%=Q%
 1020 PRINT M%
 1030 INPUT"NUM OF COP :"Q%:IF Q%<>0 THEN M%=Q%
 1040 FOR I=1 TO M%
 1050 PRINT C$(I)
 1060 INPUTLINE"CONDITION :"Q$:IF Q$<>"" THEN C$(I)=Q$
 1070 PRINT P(I)
 1080 INPUT"PRICE :"Q:IF Q<>0 THEN P(I)=Q
 1090 NEXT I
 1100 PRINT N$
 1110 INPUTLINE"NOTES :"Q$:IF Q$<>"" THEN N$=Q$
 1120 PRINT N1$
 1130 INPUTLINE N1$
 1140 PRINT#X,A$,T$,P$,I$,B$,N%,M%
 1150 FOR I=1 TO M%
 1160 PRINT#X,C$(I),P(I)
 1170 NEXT I
 1180 PRINT#X,N$,N1$
 1190 UNTIL EOF#Y
 1200 CLOSE#0
 1230 GOTO 20
 1240 
 1250 REM        COPY & OPEN FILE
 1260 DEF PROCCOPY
 1265 CLS:PRINT:PRINT" File Copy."
 1270 Y=OPENUP ":2.BOOKS"
 1280 X=OPENOUT "BK"
 1290 REPEAT
 1300 INPUT#Y,A$,T$,P$,I$,B$,N%,M%
 1305 PRINT A$
 1310 PRINT#X,A$,T$,P$,I$,B$,N%,M%
 1320 FOR I=1 TO M%
 1330 INPUT#Y,C$(I),P(I)
 1340 PRINT#X,C$(I),P(I)
 1350 NEXT I
 1360 INPUT#Y,N$,N1$
 1370 PRINT#X,N$,N1$
 1380 UNTIL EOF#Y
 1390 CLOSE#Y
 1400 ENDPROC

